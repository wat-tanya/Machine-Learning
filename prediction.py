# -*- coding: utf-8 -*-
"""prediction.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1JfM3dqf_dwfEhpJtv2ee3v7VhrVbdxZM

##LOAD CSV FILE
"""

import pandas as pd
from sklearn.linear_model import LogisticRegression

data= pd.read_csv('iris.csv')
data.head()

#displays 5 random rows from the data
data.sample(5)

data.shape # no of rows and columns

#Counts the types of specis and plots a bar
data.Species.value_counts().plot.bar()
print(data.Species.value_counts())

"""##IDENTIFY TARGET COUMN AND DATA COLUMNS"""

#Target is data vaue machine needs to classify
target = data['Species']
features = data[["SepalLengthCm", "SepalWidthCm", "PetalLengthCm", "PetalWidthCm"]]

"""##BUILD AND TRAIN A CLASSIFIER"""

classifier = LogisticRegression()

classifier.fit(features,target)

classifier.score(features,target)

soo = classifier.predict([[6.4, 3.2, 5.3, 2.3]])
so2 = classifier.predict([[5.4, 2.6, 4.1, 1.3]])
print("This is ", soo)
print("This is ", so2)

def warn(*args, **kwargs):
    pass
import warnings
warnings.warn = warn
warnings.filterwarnings('ignore')

import joblib
import pickle
joblib.dump(classifier,'IRIS_CLASS.pkl')

import numpy as np
new_X=([[5.6,2.7,4.2,1.3]])
mdl = joblib.load('IRIS_CLASS.pkl')
predictions = mdl.predict(new_X)
new_data=pd.DataFrame({'X': new_X, 'Predicted_Y': predictions})
print(new_data)

from google.colab import files
files.download('IRIS_CLASS.pkl')